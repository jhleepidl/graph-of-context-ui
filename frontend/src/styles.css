:root { font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, 'Apple Color Emoji','Segoe UI Emoji'; }
body { margin: 0; background: #f8fafc; color: #111827; }
button, input, select, textarea { font: inherit; }
.wrap { display: grid; grid-template-columns: minmax(320px, 380px) minmax(560px, 1fr) minmax(340px, 400px); height: 100vh; gap: 0; }
.col { border-right: 1px solid #e5e7eb; overflow: auto; padding: 14px; background: #fbfdff; }
.col:nth-child(2) { background: #f8fafc; }
.col:last-child { border-right: 0; background: #fbfdff; }
.row { display:flex; gap:8px; align-items:center; flex-wrap:wrap; margin-bottom:10px; }
.pill { display:inline-block; font-size:12px; padding:2px 8px; border-radius:999px; background:#f3f4f6; margin-right:6px; border: 1px solid #e5e7eb; }
.pillType { font-weight: 600; }
.pillActive { background: #ecfdf5; color: #065f46; border-color: #a7f3d0; }
.pill--default { background:#f3f4f6; color:#374151; }
.pill--resource { background:#ecfeff; color:#155e75; border-color:#a5f3fc; }
.pill--fold { background:#ecfdf5; color:#065f46; border-color:#a7f3d0; }
.pill--decision { background:#fef3c7; color:#92400e; border-color:#fcd34d; }
.pill--assumption { background:#ede9fe; color:#5b21b6; border-color:#c4b5fd; }
.pill--plan { background:#dbeafe; color:#1d4ed8; border-color:#93c5fd; }
.pill--candidate { background:#ffedd5; color:#c2410c; border-color:#fdba74; }
.card { border: 1px solid #e5e7eb; border-radius: 14px; padding: 10px; margin-bottom: 10px; background: #fff; box-shadow: 0 1px 2px rgba(15, 23, 42, 0.04); }
.card:hover { box-shadow: 0 4px 12px rgba(15, 23, 42, 0.06); }
.muted { color:#6b7280; font-size:12px; }
button { padding: 7px 11px; border-radius: 10px; border:1px solid #d1d5db; background:#fff; cursor:pointer; }
button:hover { background: #f9fafb; }
button.primary { background:#111827; color:#fff; border-color:#111827; }
button.primary:hover { background:#1f2937; }
button.danger { background:#fff; border-color:#ef4444; color:#ef4444; }
button:disabled { opacity: 0.5; cursor: not-allowed; }
input, select, textarea { border:1px solid #d1d5db; border-radius: 10px; background: #fff; }
input:focus, select:focus, textarea:focus { outline: 2px solid rgba(59,130,246,.2); border-color: #93c5fd; }
textarea { width:100%; height: 90px; resize: vertical; padding: 10px; box-sizing: border-box; }
.graphWrap { height: calc(100vh - 24px); border:1px solid #eee; border-radius: 12px; overflow:hidden; display:flex; flex-direction:column; }
.graphTools { display:flex; gap:8px; align-items:center; padding:8px; border-bottom:1px solid #eee; background:#fafafa; flex-wrap:wrap; }
.graphCanvas { flex:1; min-height:0; }
.graphDetail { border-bottom: 1px solid #eee; background: #fff; padding: 8px; max-height: 180px; overflow: auto; }
.graphDetail pre { margin: 6px 0 0; white-space: pre-wrap; font-size: 12px; }
.graphNodeCard { min-width: 220px; max-width: 220px; border: 1px solid #e5e7eb; border-radius: 12px; padding: 8px; background: #fff; box-shadow: 0 1px 0 rgba(0, 0, 0, 0.04); cursor: grab; user-select: none; }
.graphNodeCard:active { cursor: grabbing; }
.graphNodeCard.isActive { border: 2px solid #10b981; box-shadow: 0 0 0 2px rgba(16, 185, 129, 0.18); }
.graphNodeTitle { display: flex; gap: 6px; align-items: center; margin-bottom: 4px; }
.graphNodeSnippet { font-size: 11px; color: #111827; white-space: pre-wrap; }
.graphNodeMeta { margin-top: 6px; font-size: 10px; color: #6b7280; }
.graphNodeDragToActive { margin-top: 6px; display: inline-block; border: 1px dashed #93c5fd; border-radius: 8px; background: #eff6ff; color: #1d4ed8; font-size: 10px; padding: 3px 6px; pointer-events: none; }
.graphNodeDragToActive:active { cursor: grabbing; }
.graphHandle { width: 9px; height: 9px; background: #6b7280; border: 1px solid #fff; }
.graphCanvas .react-flow__node-contextNode { background: transparent; border: none; padding: 0; width: auto; }
.dropZone { border: 1px dashed #d1d5db; border-radius: 10px; padding: 8px 10px; margin-bottom: 10px; font-size: 12px; color: #6b7280; background: #f9fafb; }
.dropZone.addZone { border-color: #93c5fd; background: #eff6ff; color: #1d4ed8; }
.dropZone.removeZone { border-color: #fca5a5; background: #fef2f2; color: #b91c1c; margin-top: 8px; }
.card.dragging { opacity: 0.6; border-style: dashed; }
.activeDropSlot { height: 10px; margin: 4px 0; border-radius: 6px; border: 1px dashed transparent; background: transparent; transition: all 120ms ease; }
.activeDropSlot.isHover { border-color: #2563eb; background: rgba(37, 99, 235, 0.12); }
.tokenBar { width: 100%; height: 10px; border-radius: 999px; background: #e5e7eb; overflow: hidden; margin: 6px 0; }
.tokenBarFill { height: 100%; background: #2563eb; transition: width 160ms ease; }
.tokenBarFill.warn { background: #dc2626; }
.modalOverlay { position: fixed; inset: 0; background: rgba(15, 23, 42, 0.45); display: flex; align-items: center; justify-content: center; padding: 20px; z-index: 999; }
.modalCard { width: min(920px, 100%); max-height: calc(100vh - 40px); overflow: auto; background: #fff; border: 1px solid #e5e7eb; border-radius: 12px; padding: 12px; }
.modalHeader { justify-content: space-between; }
.modalPartList { max-height: 220px; overflow: auto; }

.graphNodeCard { transition: box-shadow 120ms ease, border-color 120ms ease; }
.graphNodeCard.tone-default { border-color: #e5e7eb; background: #ffffff; }
.graphNodeCard.tone-user { border-color: #bfdbfe; background: #eff6ff; }
.graphNodeCard.tone-assistant { border-color: #c7d2fe; background: #eef2ff; }
.graphNodeCard.tone-resource { border-color: #a5f3fc; background: #ecfeff; }
.graphNodeCard.tone-fold { border-color: #a7f3d0; background: #ecfdf5; }
.graphNodeCard.tone-decision { border-color: #fcd34d; background: #fffbeb; }
.graphNodeCard.tone-assumption { border-color: #c4b5fd; background: #f5f3ff; }
.graphNodeCard.tone-plan { border-color: #93c5fd; background: #eff6ff; }
.graphNodeCard.tone-candidate { border-color: #fdba74; background: #fff7ed; }

@media (max-width: 1280px) {
  .wrap { grid-template-columns: 320px 1fr 340px; }
}
@media (max-width: 1024px) {
  .wrap { grid-template-columns: 1fr; height: auto; }
  .col { border-right: 0; border-bottom: 1px solid #e5e7eb; min-height: 320px; }
  .graphWrap { height: 70vh; }
}
